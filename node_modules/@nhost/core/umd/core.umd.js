(function(S,g){typeof exports=="object"&&typeof module<"u"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(S=typeof globalThis<"u"?globalThis:S||self,g(S["@nhost/core"]={}))})(this,function(S){"use strict";var go=Object.defineProperty;var Eo=(S,g,re)=>g in S?go(S,g,{enumerable:!0,configurable:!0,writable:!0,value:re}):S[g]=re;var he=(S,g,re)=>(Eo(S,typeof g!="symbol"?g+"":g,re),re);/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var g=function(){return g=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},g.apply(this,arguments)};function re(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function R(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function U(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var k;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(k||(k={}));var ce;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(ce||(ce={}));var Rt=k.Start,Ot=k.Stop,ge=k.Raise,Ee=k.Send,or=k.Cancel,In=k.NullEvent,At=k.Assign;k.After,k.DoneState;var ar=k.Log,_n=k.Init,xt=k.Invoke;k.ErrorExecution;var cr=k.ErrorPlatform,Pn=k.ErrorCustom,ur=k.Update,Cn=k.Choose,kn=k.Pure,lr=".",fr={},Nt="xstate.guard",Dn="",B=process.env.NODE_ENV==="production",Ye;function It(t,e,r){r===void 0&&(r=lr);var n=ke(t,r),i=ke(e,r);return I(i)?I(n)?i===n:!1:I(n)?n in i:Object.keys(n).every(function(s){return s in i?It(n[s],i[s]):!1})}function dr(t){try{return I(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function _t(t,e){try{return we(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function Un(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function ke(t,e){if(Un(t))return t.value;if(we(t))return Qe(t);if(typeof t!="string")return t;var r=_t(t,e);return Qe(r)}function Qe(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function De(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function hr(t,e,r){var n,i,s={};try{for(var o=R(Object.keys(t)),a=o.next();!a.done;a=o.next()){var u=a.value,c=t[u];!r(c)||(s[u]=e(c,u,t))}}catch(f){n={error:f}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var Ln=function(t){return function(e){var r,n,i=e;try{for(var s=R(t),o=s.next();!o.done;o=s.next()){var a=o.value;i=i[a]}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Mn(t,e){return function(r){var n,i,s=r;try{for(var o=R(t),a=o.next();!a.done;a=o.next()){var u=a.value;s=s[e][u]}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function Xe(t){if(!t)return[[]];if(I(t))return[[t]];var e=j(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:Xe(t[r]).map(function(i){return[r].concat(i)})}));return e}function j(t){var e;return(e=[]).concat.apply(e,U([],O(t),!1))}function pr(t){return we(t)?t:[t]}function J(t){return t===void 0?[]:pr(t)}function Ze(t,e,r){var n,i;if(D(t))return t(e,r.data);var s={};try{for(var o=R(Object.keys(t)),a=o.next();!a.done;a=o.next()){var u=a.value,c=t[u];D(c)?s[u]=c(e,r.data):s[u]=c}}catch(f){n={error:f}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function jn(t){return/^(done|error)\./.test(t)}function mr(t){return!!(t instanceof Promise||t!==null&&(D(t)||typeof t=="object")&&D(t.then))}function Fn(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Bn(t,e){var r,n,i=O([[],[]],2),s=i[0],o=i[1];try{for(var a=R(t),u=a.next();!u.done;u=a.next()){var c=u.value;e(c)?s.push(c):o.push(c)}}catch(f){r={error:f}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return[s,o]}function vr(t,e){return De(t.states,function(r,n){if(!!r){var i=(I(e)?void 0:e[n])||(r?r.current:void 0);if(!!i)return{current:i,states:vr(r,i)}}})}function Vn(t,e){return{current:e,states:vr(t,e)}}function yr(t,e,r,n){B||K(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var a,u,c=o.assignment,f={state:n,action:o,_event:e},m={};if(D(c))m=c(s,e.data,f);else try{for(var p=R(Object.keys(c)),d=p.next();!d.done;d=p.next()){var l=d.value,h=c[l];m[l]=D(h)?h(s,e.data,f):h}}catch(y){a={error:y}}finally{try{d&&!d.done&&(u=p.return)&&u.call(p)}finally{if(a)throw a.error}}return Object.assign({},s,m)},t);return i}var K=function(){};B||(K=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function we(t){return Array.isArray(t)}function D(t){return typeof t=="function"}function I(t){return typeof t=="string"}function gr(t,e){if(!!t)return I(t)?{type:Nt,name:t,predicate:e?e[t]:void 0}:D(t)?{type:Nt,name:t.name,predicate:t}:t}function Kn(t){try{return"subscribe"in t&&D(t.subscribe)}catch{return!1}}var ue=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();Ye={},Ye[ue]=function(){return this},Ye[Symbol.observable]=function(){return this};function pe(t){return!!t&&"__xstatenode"in t}function $n(t){return!!t&&typeof t.send=="function"}function Pt(t,e){return I(t)||typeof t=="number"?g({type:t},e):t}function $(t,e){if(!I(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=Pt(t);return g({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function Se(t,e){var r=pr(e).map(function(n){return typeof n>"u"||typeof n=="string"||pe(n)?{target:n,event:t}:g(g({},n),{event:t})});return r}function qn(t){if(!(t===void 0||t===Dn))return J(t)}function zn(t,e,r){if(!B){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function Er(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===Nt)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var a=s==null?void 0:s[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return a(r,n.data,o)}function wr(t){return typeof t=="string"?{type:t}:t}function et(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function tt(t,e){return"".concat(t,":invocation[").concat(e,"]")}var Te=$({type:_n});function Ct(t,e){return e&&e[t]||void 0}function Ue(t,e){var r;if(I(t)||typeof t=="number"){var n=Ct(t,e);D(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if(D(t))r={type:t.name||t.toString(),exec:t};else{var n=Ct(t.type,e);if(D(n))r=g(g({},t),{exec:n});else if(n){var i=n.type||t.type;r=g(g(g({},n),t),{type:i})}else r=t}return r}var le=function(t,e){if(!t)return[];var r=we(t)?t:[t];return r.map(function(n){return Ue(n,e)})};function kt(t){var e=Ue(t);return g(g({id:I(t)?t:e.id},e),{type:e.type})}function Hn(t){return I(t)?{type:ge,event:t}:Dt(t,{to:ce.Internal})}function Gn(t){return{type:ge,_event:$(t.event)}}function Dt(t,e){return{to:e?e.to:void 0,type:Ee,event:D(t)?t:Pt(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:D(t)?t.name:dr(t)}}function Wn(t,e,r,n){var i={_event:r},s=$(D(t.event)?t.event(e,r.data,i):t.event),o;if(I(t.delay)){var a=n&&n[t.delay];o=D(a)?a(e,r.data,i):a}else o=D(t.delay)?t.delay(e,r.data,i):t.delay;var u=D(t.to)?t.to(e,r.data,i):t.to;return g(g({},t),{to:u,_event:s,event:s.data,delay:o})}var Jn=function(t,e,r){return g(g({},t),{value:I(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},Yn=function(t){return{type:or,sendId:t}};function Qn(t){var e=kt(t);return{type:k.Start,activity:e,exec:void 0}}function Xn(t){var e=D(t)?t:kt(t);return{type:k.Stop,activity:e,exec:void 0}}function Zn(t,e,r){var n=D(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:k.Stop,activity:i};return s}var ei=function(t){return{type:At,assignment:t}};function ti(t,e){var r=e?"#".concat(e):"";return"".concat(k.After,"(").concat(t,")").concat(r)}function rt(t,e){var r="".concat(k.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function nt(t,e){var r="".concat(k.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function Le(t,e){var r="".concat(k.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}var ri=function(t){var e,r,n=[];try{for(var i=R(t),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.length;){if(o[a].type===At){n.push(o[a]),o.splice(a,1);continue}a++}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function it(t,e,r,n,i,s,o){o===void 0&&(o=!1);var a=o?[]:ri(i),u=a.length?yr(r,n,a,e):r,c=o?[r]:void 0,f=[];function m(l){var h;switch(l.type){case ge:return Gn(l);case Ee:var y=Wn(l,u,n,t.options.delays);return B||K(!I(l.delay)||typeof y.delay=="number","No delay reference for delay expression '".concat(l.delay,"' was found on machine '").concat(t.id,"'")),s&&y.to!==ce.Internal&&f.push(y),y;case ar:{var E=Jn(l,u,n);return s==null||s(E,u,n),E}case Cn:{var w=l,T=(h=w.conds.find(function(Q){var ae=gr(Q.cond,t.options.guards);return!ae||Er(t,ae,u,n,s?void 0:e)}))===null||h===void 0?void 0:h.actions;if(!T)return[];var _=O(it(t,e,u,n,[le(J(T),t.options.actions)],s,o),2),A=_[0],M=_[1];return u=M,c==null||c.push(u),A}case kn:{var T=l.get(u,n.data);if(!T)return[];var x=O(it(t,e,u,n,[le(J(T),t.options.actions)],s,o),2),P=x[0],C=x[1];return u=C,c==null||c.push(u),P}case Ot:{var E=Zn(l,u,n);return s==null||s(E,r,n),E}case At:{u=yr(u,n,[l],s?void 0:e),c==null||c.push(u);break}default:var b=Ue(l,t.options.actions),L=b.exec;if(s)s(b,u,n);else if(L&&c){var W=c.length-1;b=g(g({},b),{exec:function(Q){for(var ae=[],_e=1;_e<arguments.length;_e++)ae[_e-1]=arguments[_e];L.apply(void 0,U([c[W]],O(ae),!1))}})}return b}}function p(l){var h,y,E=[];try{for(var w=R(l),T=w.next();!T.done;T=w.next()){var _=T.value,A=m(_);A&&(E=E.concat(A))}}catch(M){h={error:M}}finally{try{T&&!T.done&&(y=w.return)&&y.call(w)}finally{if(h)throw h.error}}return f.forEach(function(M){s(M,u,n)}),f.length=0,E}var d=j(i.map(p));return[d,u]}var be=function(t,e){var r=e(t);return r};function Sr(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[ue]=function(){return this},e}function ni(t,e,r,n){var i,s=wr(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],a=t.data?Ze(t.data,r,n):void 0,u=o?Tr(o,t.id,a):Sr(t.id);return u.meta=t,u}function Tr(t,e,r){var n=Sr(e);if(n.deferred=!0,pe(t)){var i=n.state=be(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function ii(t){try{return typeof t.send=="function"}catch{return!1}}function si(t){return ii(t)&&"id"in t}function oi(t){var e;return g((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[ue]=function(){return this},e),t)}var st=function(t){return t.type==="atomic"||t.type==="final"};function br(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function Me(t){return br(t).filter(function(e){return e.type!=="history"})}function Rr(t){var e=[t];return st(t)?e:e.concat(j(Me(t).map(Rr)))}function je(t,e){var r,n,i,s,o,a,u,c,f=new Set(t),m=Ut(f),p=new Set(e);try{for(var d=R(p),l=d.next();!l.done;l=d.next())for(var h=l.value,y=h.parent;y&&!p.has(y);)p.add(y),y=y.parent}catch(C){r={error:C}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}var E=Ut(p);try{for(var w=R(p),T=w.next();!T.done;T=w.next()){var h=T.value;if(h.type==="compound"&&(!E.get(h)||!E.get(h).length))m.get(h)?m.get(h).forEach(function(b){return p.add(b)}):h.initialStateNodes.forEach(function(b){return p.add(b)});else if(h.type==="parallel")try{for(var _=(o=void 0,R(Me(h))),A=_.next();!A.done;A=_.next()){var M=A.value;p.has(M)||(p.add(M),m.get(M)?m.get(M).forEach(function(b){return p.add(b)}):M.initialStateNodes.forEach(function(b){return p.add(b)}))}}catch(b){o={error:b}}finally{try{A&&!A.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}}}catch(C){i={error:C}}finally{try{T&&!T.done&&(s=w.return)&&s.call(w)}finally{if(i)throw i.error}}try{for(var x=R(p),P=x.next();!P.done;P=x.next())for(var h=P.value,y=h.parent;y&&!p.has(y);)p.add(y),y=y.parent}catch(C){u={error:C}}finally{try{P&&!P.done&&(c=x.return)&&c.call(x)}finally{if(u)throw u.error}}return p}function Or(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(st(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=Or(s,e)}),i}function Ut(t){var e,r,n=new Map;try{for(var i=R(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(a){e={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function ai(t,e){var r=je([t],e);return Or(t,Ut(r))}function Fe(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function ci(t){return U([],O(new Set(j(U([],O(t.map(function(e){return e.ownEvents})),!1)))),!1)}function ot(t,e){return e.type==="compound"?Me(e).some(function(r){return r.type==="final"&&Fe(t,r)}):e.type==="parallel"?Me(e).every(function(r){return ot(t,r)}):!1}function ui(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function Ar(t){return new Set(j(t.map(function(e){return e.tags})))}function xr(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(I(t)||I(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return xr(t[i],e[i])})}function li(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function fi(t,e){var r=t.exec,n=g(g({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var Z=function(){function t(e){var r=this,n;this.actions=[],this.activities=fr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||fr,this.meta=ui(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return ci(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=Te;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=Te;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),I(e))return[e];var i=Object.keys(e);return i.concat.apply(i,U([],O(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=re(e,["configuration","transitions","tags","machine"]);return g(g({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return It(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;B&&K(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),di={deferEvents:!1},Nr=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=g(g({},di),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),Lt=new Map,hi=0,at={bookId:function(){return"x:".concat(hi++)},register:function(t,e){return Lt.set(t,e),t},get:function(t){return Lt.get(t)},free:function(t){Lt.delete(t)}};function Mt(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;B||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function pi(){var t=Mt();if(t&&"__xstate__"in t)return t.__xstate__}function mi(t){if(!!Mt()){var e=pi();e&&e.register(t)}}function vi(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var c=i.shift();r=t.transition(r,c,u),n.forEach(function(f){return f.next(r)})}s=!1}},a=oi({id:e.id,send:function(c){i.push(c),o()},getSnapshot:function(){return r},subscribe:function(c,f,m){var p=et(c,f,m);return n.add(p),p.next(r),{unsubscribe:function(){n.delete(p)}}}}),u={parent:e.parent,self:a,id:e.id||"anonymous",observers:n};return r=t.start?t.start(u):r,a}var yi={sync:!1,autoForward:!1},V;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(V||(V={}));var gi=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=V.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(f,m){if(we(f))return n.batch(f),n.state;var p=$(Pt(f,m));if(n.status===V.Stopped)return B||K(!1,'Event "'.concat(p.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(p.data))),n.state;if(n.status!==V.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(p.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(p.data)));return n.scheduler.schedule(function(){n.forward(p);var d=n._nextState(p);n.update(d,p)}),n._state},this.sendTo=function(f,m,p){var d=n.parent&&(m===ce.Parent||n.parent.id===m),l=d?n.parent:I(m)?n.children.get(m)||at.get(m):$n(m)?m:void 0;if(!l){if(!d)throw new Error("Unable to send event to child '".concat(m,"' from service '").concat(n.id,"'."));B||K(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(f.type));return}if("machine"in l){if(n.status!==V.Stopped||n.parent!==l||n.state.done){var h=g(g({},f),{name:f.name===Pn?"".concat(Le(n.id)):f.name,origin:n.sessionId});!p&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([l,h]):l.send(h)}}else!p&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([l,f.data]):l.send(f.data)},this._exec=function(f,m,p,d){d===void 0&&(d=n.machine.options.actions);var l=f.exec||Ct(f.type,d),h=D(l)?l:l?l.exec:f.exec;if(h)try{return h(m,p.data,n.machine.config.predictableActionArguments?{action:f,_event:p}:{action:f,state:n.state,_event:p})}catch(W){throw n.parent&&n.parent.send({type:"xstate.error",data:W}),W}switch(f.type){case Ee:var y=f;if(typeof y.delay=="number"){n.defer(y);return}else y.to?n.sendTo(y._event,y.to,p===Te):n.send(y._event);break;case or:n.cancel(f.sendId);break;case Rt:{if(n.status!==V.Running)return;var E=f.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[E.id||E.type])break;if(E.type===k.Invoke){var w=wr(E.src),T=n.machine.options.services?n.machine.options.services[w.type]:void 0,_=E.id,A=E.data;B||K(!("forward"in E),"`forward` property is deprecated (found in invocation of '".concat(E.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var M="autoForward"in E?E.autoForward:!!E.forward;if(!T){B||K(!1,"No service found for invocation '".concat(E.src,"' in machine '").concat(n.machine.id,"'."));return}var x=A?Ze(A,m,p):void 0;if(typeof T=="string")return;var P=D(T)?T(m,p.data,{data:x,src:w,meta:E.meta}):T;if(!P)return;var C=void 0;pe(P)&&(P=x?P.withContext(x):P,C={autoForward:M}),n.spawn(P,_,C)}else n.spawnActivity(E);break}case Ot:{n.stopChild(f.activity.id);break}case ar:var b=f.label,L=f.value;b?n.logger(b,L):n.logger(L);break;default:B||K(!1,"No implementation found for action type '".concat(f.type,"'"));break}};var i=g(g({},t.defaultOptions),r),s=i.clock,o=i.logger,a=i.parent,u=i.id,c=u!==void 0?u:e.id;this.id=c,this.logger=o,this.clock=s,this.parent=a,this.options=i,this.scheduler=new Nr({deferEvents:this.options.deferEvents}),this.sessionId=at.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:be(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return B||K(this.status!==V.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=R(e.actions),o=s.next();!o.done;o=s.next()){var a=o.value;this.exec(a,e,r)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,a,u,c,f,m=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===Te)&&this.options.execute)this.execute(this.state);else for(var p=void 0;p=this._outgoingQueue.shift();)p[0].send(p[1]);if(this.children.forEach(function(C){m.state.children[C.id]=C}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var d=R(this.eventListeners),l=d.next();!l.done;l=d.next()){var h=l.value;h(e.event)}}catch(C){n={error:C}}finally{try{l&&!l.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}try{for(var y=R(this.listeners),E=y.next();!E.done;E=y.next()){var h=E.value;h(e,e.event)}}catch(C){s={error:C}}finally{try{E&&!E.done&&(o=y.return)&&o.call(y)}finally{if(s)throw s.error}}try{for(var w=R(this.contextListeners),T=w.next();!T.done;T=w.next()){var _=T.value;_(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(C){a={error:C}}finally{try{T&&!T.done&&(u=w.return)&&u.call(w)}finally{if(a)throw a.error}}if(this.state.done){var A=e.configuration.find(function(C){return C.type==="final"&&C.parent===m.machine}),M=A&&A.doneData?Ze(A.doneData,e.context,r):void 0;try{for(var x=R(this.doneListeners),P=x.next();!P.done;P=x.next()){var h=P.value;h(nt(this.id,M))}}catch(C){c={error:C}}finally{try{P&&!P.done&&(f=x.return)&&f.call(x)}finally{if(c)throw c.error}}this._stop(),this._stopChildren()}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===V.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=et(e,r,n);this.listeners.add(s.next),this.status!==V.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===V.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===V.Running)return this;this.machine._init(),at.register(this.sessionId,this),this.initialized=!0,this.status=V.Running;var n=e===void 0?this.initialState:be(this,function(){return li(e)?r.machine.resolveState(e):r.machine.resolveState(Z.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,Te)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){D(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,a,u,c,f;try{for(var m=R(this.listeners),p=m.next();!p.done;p=m.next()){var d=p.value;this.listeners.delete(d)}}catch(x){e={error:x}}finally{try{p&&!p.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}try{for(var l=R(this.stopListeners),h=l.next();!h.done;h=l.next()){var d=h.value;d(),this.stopListeners.delete(d)}}catch(x){n={error:x}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}try{for(var y=R(this.contextListeners),E=y.next();!E.done;E=y.next()){var d=E.value;this.contextListeners.delete(d)}}catch(x){s={error:x}}finally{try{E&&!E.done&&(o=y.return)&&o.call(y)}finally{if(s)throw s.error}}try{for(var w=R(this.doneListeners),T=w.next();!T.done;T=w.next()){var d=T.value;this.doneListeners.delete(d)}}catch(x){a={error:x}}finally{try{T&&!T.done&&(u=w.return)&&u.call(w)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.initialized=!1,this.status=V.Stopped,this._initialState=void 0;try{for(var _=R(Object.keys(this.delayedEventsMap)),A=_.next();!A.done;A=_.next()){var M=A.value;this.clock.clearTimeout(this.delayedEventsMap[M])}}catch(x){c={error:x}}finally{try{A&&!A.done&&(f=_.return)&&f.call(_)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new Nr({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n=$({type:"xstate.stop"}),i=be(e,function(){var s=j(U([],O(e.state.configuration),!1).sort(function(f,m){return m.order-f.order}).map(function(f){return le(f.onExit,e.machine.options.actions)})),o=O(it(e.machine,e.state,e.state.context,n,[s],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),a=o[0],u=o[1],c=new Z({value:e.state.value,context:u,_event:n,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:a.filter(function(f){return f.type!==ge&&(f.type!==Ee||!!f.to&&f.to!==ce.Internal)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return c.changed=!0,c});e.update(i,n),e._stopChildren(),at.free(e.sessionId)}),this},t.prototype.batch=function(e){var r=this;if(this.status===V.NotStarted&&this.options.deferEvents)B||K(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==V.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(!!e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,a=!1,u=[],c=function(d){var l=$(d);r.forward(l),o=be(r,function(){return r.machine.transition(o,l,void 0,n||void 0)}),u.push.apply(u,U([],O(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(h){return fi(h,o)})),!1)),a=a||!!o.changed};try{for(var f=R(e),m=f.next();!m.done;m=f.next()){var p=m.value;c(p)}}catch(d){i={error:d}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}o.changed=a,o.actions=u,r.update(o,$(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=$(e);if(i.name.indexOf(cr)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(cr)===0}))throw i.data.data;var s=be(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=R(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);!r||(this.removeChild(e),D(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==V.Running)return Tr(e,r);if(mr(e))return this.spawnPromise(Promise.resolve(e),r);if(D(e))return this.spawnCallback(e,r);if(si(e))return this.spawnActor(e,r);if(Kn(e))return this.spawnObservable(e,r);if(pe(e))return this.spawnMachine(e,g(g({},n),{id:r}));if(Fn(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,g(g({},this.options),{parent:this,id:r.id||e.id})),s=g(g({},yi),r);s.sync&&i.onTransition(function(a){n.send(ur,{state:a,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(a){n.removeChild(i.id),n.send($(a,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=vi(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(u){s||(o=u,i.removeChild(r),i.send($(nt(r,u),{origin:r})))},function(u){if(!s){i.removeChild(r);var c=Le(r,u);try{i.send($(c,{origin:r}))}catch(f){zn(u,f,r),i.devTools&&i.devTools.send(c,i.state),i.machine.strict&&i.stop()}}});var a=(n={id:r,send:function(){},subscribe:function(u,c,f){var m=et(u,c,f),p=!1;return e.then(function(d){p||(m.next(d),!p&&m.complete())},function(d){p||m.error(d)}),{unsubscribe:function(){return p=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[ue]=function(){return this},n);return this.children.set(r,a),a},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,a=new Set,u,c=function(p){u=p,a.forEach(function(d){return d(p)}),!s&&i.send($(p,{origin:r}))},f;try{f=e(c,function(p){o.add(p)})}catch(p){this.send(Le(r,p))}if(mr(f))return this.spawnPromise(f,r);var m=(n={id:r,send:function(p){return o.forEach(function(d){return d(p)})},subscribe:function(p){var d=et(p);return a.add(d.next),{unsubscribe:function(){a.delete(d.next)}}},stop:function(){s=!0,D(f)&&f()},toJSON:function(){return{id:r}},getSnapshot:function(){return u}},n[ue]=function(){return this},n);return this.children.set(r,m),m},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(u){s=u,i.send($(u,{origin:r}))},function(u){i.removeChild(r),i.send($(Le(r,u),{origin:r}))},function(){i.removeChild(r),i.send($(nt(r),{origin:r}))}),a=(n={id:r,send:function(){},subscribe:function(u,c,f){return e.subscribe(u,c,f)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[ue]=function(){return this},n);return this.children.set(r,a),a},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){B||K(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[ue]=function(){return this},n))},t.prototype.attachDev=function(){var e=Mt();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(g(g({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:g({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}mi(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[ue]=function(){return this},t.prototype.getSnapshot=function(){return this.status===V.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=Ir,t}();function Ir(t,e){var r=new gi(t,e);return r}function Ei(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function ct(t){return g(g({type:xt},t),{toJSON:function(){t.onDone,t.onError;var e=re(t,["onDone","onError"]);return g(g({},e),{type:xt,src:Ei(t.src)})}})}var Re="",jt="#",Be="*",Oe={},Ae=function(t){return t[0]===jt},wi=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Si=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(I(s.target)||pe(s.target))}),i=e===Re?"the transient event":"event '".concat(e,"'");K(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Ti=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(wi(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:lr),this.id=this.config.id||U([this.machine.key],O(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,B||K(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?De(this.config.states,function(c,f){var m,p=new t(c,{},void 0,{parent:s,key:f});return Object.assign(s.idMap,g((m={},m[p.id]=p,m),p.idMap)),p}):Oe;var a=0;function u(c){var f,m;c.order=a++;try{for(var p=R(br(c)),d=p.next();!d.done;d=p.next()){var l=d.value;u(l)}}catch(h){f={error:h}}finally{try{d&&!d.done&&(m=p.return)&&m.call(p)}finally{if(f)throw f.error}}}u(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(c){var f=c.event;return f===Re}):Re in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=J(this.config.entry||this.config.onEntry).map(function(c){return Ue(c)}),this.onExit=J(this.config.exit||this.config.onExit).map(function(c){return Ue(c)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=J(this.config.invoke).map(function(c,f){var m,p;if(pe(c)){var d=tt(s.id,f);return s.machine.options.services=g((m={},m[d]=c,m),s.machine.options.services),ct({src:d,id:d})}else if(I(c.src)){var d=c.id||tt(s.id,f);return ct(g(g({},c),{id:d,src:c.src}))}else if(pe(c.src)||D(c.src)){var d=c.id||tt(s.id,f);return s.machine.options.services=g((p={},p[d]=c.src,p),s.machine.options.services),ct(g(g({id:d},c),{src:d}))}else{var l=c.src;return ct(g(g({id:tt(s.id,f)},c),{src:l}))}}),this.activities=J(this.config.activities).concat(this.invoke).map(function(c){return kt(c)}),this.transition=this.transition.bind(this),this.tags=J(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Rr(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,a=n.services,u=n.delays;return new t(this.config,{actions:g(g({},i),e.actions),activities:g(g({},s),e.activities),guards:g(g({},o),e.guards),services:g(g({},a),e.services),delays:g(g({},u),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return D(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:De(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===Re,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===Be});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var a=D(s)?"".concat(e.id,":delay[").concat(o,"]"):s,u=ti(a,e.id);return e.onEntry.push(Dt(u,{delay:s})),e.onExit.push(Yn(u)),u},i=we(r)?r.map(function(s,o){var a=n(s.delay,o);return g(g({},s),{event:a})}):j(Object.keys(r).map(function(s,o){var a=r[s],u=I(a)?{target:a}:a,c=isNaN(+s)?s:+s,f=n(c,o);return J(u).map(function(m){return g(g({},m),{event:f,delay:c})})}));return i.map(function(s){var o=s.delay;return g(g({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof Z?e.value:ke(e,this.delimiter);if(I(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),a=[this];return a.push.apply(a,U([],O(j(o.map(function(u){return n.getStateNode(u).getStateNodes(i[u])}))),!1)),a},t.prototype.handles=function(e){var r=dr(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof Z?e:Z.create(e),n=Array.from(je([],this.getStateNodes(r.value)));return new Z(g(g({},r),{value:this.resolve(r.value),configuration:n,done:ot(n,this),tags:Ar(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var a=R(Object.keys(e)),u=a.next();!u.done;u=a.next()){var c=u.value,f=e[c];if(!!f){var m=this.getStateNode(c),p=m._transition(f,r,n);p&&(o[c]=p)}}}catch(w){i={error:w}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}var d=Object.keys(o).map(function(w){return o[w]}),l=j(d.map(function(w){return w.transitions})),h=d.some(function(w){return w.transitions.length>0});if(!h)return this.next(r,n);var y=j(d.map(function(w){return w.entrySet})),E=j(Object.keys(o).map(function(w){return o[w].configuration}));return{transitions:l,entrySet:y,exitSet:j(d.map(function(w){return w.exitSet})),configuration:E,source:r,actions:j(Object.keys(o).map(function(w){return o[w].actions}))}},t.prototype._transition=function(e,r,n){return I(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,$(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,a=[],u=[],c;try{for(var f=R(this.getCandidates(o)),m=f.next();!m.done;m=f.next()){var p=m.value,d=p.cond,l=p.in,h=e.context,y=l?I(l)&&Ae(l)?e.matches(ke(this.getStateNodeById(l).path,this.delimiter)):It(ke(l,this.delimiter),Ln(this.path.slice(0,-2))(e.value)):!0,E=!1;try{E=!d||Er(this.machine,d,h,r,e)}catch(A){throw new Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(A.message))}if(E&&y){p.target!==void 0&&(u=p.target),a.push.apply(a,U([],O(p.actions),!1)),c=p;break}}}catch(A){n={error:A}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}if(!!c){if(!u.length)return{transitions:[c],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var w=j(u.map(function(A){return s.getRelativeStateNodes(A,e.historyValue)})),T=!!c.internal,_=[];return T||u.forEach(function(A){_.push.apply(_,U([],O(s.getExternalReentryNodes(A)),!1))}),{transitions:[c],entrySet:_,exitSet:T?[]:[this],configuration:w,source:e,actions:a}}},t.prototype.getExternalReentryNodes=function(e){for(var r=[],n=O(e.order>this.order?[e,this]:[this,e],2),i=n[0],s=n[1];i&&i!==s;)r.push(i),i=i.parent;return i!==s?[]:(r.push(s),r)},t.prototype.getActions=function(e,r,n,i,s,o,a){var u,c,f,m,p=this,d=je([],o?this.getStateNodes(o.value):[this]);try{for(var l=R(e),h=l.next();!h.done;h=l.next()){var y=h.value;(!Fe(d,y)||Fe(n.entrySet,y.parent))&&n.entrySet.push(y)}}catch(b){u={error:b}}finally{try{h&&!h.done&&(c=l.return)&&c.call(l)}finally{if(u)throw u.error}}try{for(var E=R(d),w=E.next();!w.done;w=E.next()){var y=w.value;(!Fe(e,y)||Fe(n.exitSet,y.parent))&&n.exitSet.push(y)}}catch(b){f={error:b}}finally{try{w&&!w.done&&(m=E.return)&&m.call(E)}finally{if(f)throw f.error}}var T=j(n.entrySet.map(function(b){var L=[];if(b.type!=="final")return L;var W=b.parent;if(!W.parent)return L;L.push(rt(b.id,b.doneData),rt(W.id,b.doneData?Ze(b.doneData,i,s):void 0));var Q=W.parent;return Q.type==="parallel"&&Me(Q).every(function(ae){return ot(n.configuration,ae)})&&L.push(rt(Q.id)),L}));n.exitSet.sort(function(b,L){return L.order-b.order}),n.entrySet.sort(function(b,L){return b.order-L.order});var _=new Set(n.entrySet),A=new Set(n.exitSet),M=Array.from(_).map(function(b){var L=b.onEntry,W=b.activities.map(function(Q){return Qn(Q)});return le(a?U(U([],O(L),!1),O(W),!1):U(U([],O(W),!1),O(L),!1),p.machine.options.actions)}).concat([T.map(Hn)]),x=Array.from(A).map(function(b){return le(U(U([],O(b.onExit),!1),O(b.activities.map(function(L){return Xn(L)})),!1),p.machine.options.actions)}),P=x.concat([le(n.actions,this.machine.options.actions)]).concat(M);if(r){var C=le(j(U([],O(e),!1).sort(function(b,L){return L.order-b.order}).map(function(b){return b.onExit})),this.machine.options.actions).filter(function(b){return b.type!==ge&&(b.type!==Ee||!!b.to&&b.to!==ce.Internal)});return P.concat([C])}return P},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=$(r),o;if(e instanceof Z)o=n===void 0?e:this.resolveState(Z.from(e,n));else{var a=I(e)?this.resolve(Qe(this.getResolvedPath(e))):this.resolve(e),u=n!=null?n:this.machine.context;o=this.resolveState(Z.from(a,u))}if(!B&&s.name===Be)throw new Error("An event cannot have the wildcard type ('".concat(Be,"')"));if(this.strict&&!this.events.includes(s.name)&&!jn(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var c=this._transition(o.value,o,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},f=je([],this.getStateNodes(o.value)),m=c.configuration.length?je(f,c.configuration):f;return c.configuration=U([],O(m),!1),this.resolveTransition(c,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,U([],O(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,a,u,c,f=this;s===void 0&&(s=Te);var m=e.configuration,p=!r||e.transitions.length>0,d=p?e.configuration:r?r.configuration:[],l=ot(d,this),h=p?ai(this.machine,m):void 0,y=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,E=this.getActions(new Set(d),l,e,n,s,r,i),w=r?g({},r.activities):{};try{for(var T=R(E),_=T.next();!_.done;_=T.next()){var A=_.value;try{for(var M=(u=void 0,R(A)),x=M.next();!x.done;x=M.next()){var P=x.value;P.type===Rt?w[P.activity.id||P.activity.type]=P:P.type===Ot&&(w[P.activity.id||P.activity.type]=!1)}}catch(G){u={error:G}}finally{try{x&&!x.done&&(c=M.return)&&c.call(M)}finally{if(u)throw u.error}}}}catch(G){o={error:G}}finally{try{_&&!_.done&&(a=T.return)&&a.call(T)}finally{if(o)throw o.error}}var C=O(it(this,r,n,s,E,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),b=C[0],L=C[1],W=O(Bn(b,function(G){return G.type===ge||G.type===Ee&&G.to===ce.Internal}),2),Q=W[0],ae=W[1],_e=b.filter(function(G){var Ce;return G.type===Rt&&((Ce=G.activity)===null||Ce===void 0?void 0:Ce.type)===xt}),mo=_e.reduce(function(G,Ce){return G[Ce.activity.id]=ni(Ce.activity,f.machine,L,s),G},r?g({},r.children):{}),bt=new Z({value:h||r.value,context:L,_event:s,_sessionid:r?r._sessionid:null,historyValue:h?y?Vn(y,h):void 0:r?r.historyValue:void 0,history:!h||e.source?r:void 0,actions:h?ae:[],activities:h?w:r?r.activities:{},events:[],configuration:d,transitions:e.transitions,children:mo,done:l,tags:Ar(d),machine:this}),xn=n!==L;bt.changed=s.name===ur||xn;var Pe=bt.history;Pe&&delete Pe.history;var Nn=!l&&(this._transient||m.some(function(G){return G._transient}));if(!p&&(!Nn||s.name===Re))return bt;var X=bt;if(!l)for(Nn&&(X=this.resolveRaisedTransition(X,{type:In},s,i));Q.length;){var vo=Q.shift();X=this.resolveRaisedTransition(X,vo._event,s,i)}var yo=X.changed||(Pe?!!X.actions.length||xn||typeof Pe.value!=typeof X.value||!xr(X.value,Pe.value):void 0);return X.changed=yo,X.history=Pe,X},t.prototype.getStateNode=function(e){if(Ae(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=Ae(e)?e.slice(jt.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Ae(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=_t(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||Oe;switch(this.type){case"parallel":return De(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):Oe});case"compound":if(I(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?De(e,function(s,o){return s?n.getStateNode(o).resolve(s):Oe}):this.initialStateValue||{};default:return e||Oe}},t.prototype.getResolvedPath=function(e){if(Ae(e)){var r=this.machine.idMap[e.slice(jt.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return _t(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=hr(this.states,function(n){return n.initialStateValue||Oe},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=st(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:U([],O(n),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;I(r.target)?e=Ae(r.target)?Qe(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(st(this))return[this];if(this.type==="compound"&&!this.initial)return B||K(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=Xe(this.initialStateValue);return j(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=O(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(!!Object.keys(this.states).length)return{current:e||this.initialStateValue,states:hr(this.states,function(r,n){if(!e)return r.historyValue();var i=I(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?j(Xe(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=Mn(n.path,"states")(e).current;return I(s)?[n.getStateNode(s)]:j(Xe(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=j(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var a=R(Object.keys(s)),u=a.next();!u.done;u=a.next()){var c=u.value,f=s[c];if(f.states)try{for(var m=(n=void 0,R(f.events)),p=m.next();!p.done;p=m.next()){var d=p.value;o.add("".concat(d))}}catch(l){n={error:l}}finally{try{p&&!p.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}}catch(l){e={error:l}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!I(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(a){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(a.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=qn(e.target),i="internal"in e?e.internal:n?n.some(function(u){return I(u)&&u[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),a=g(g({},e),{actions:le(J(e.actions)),cond:gr(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return g(g({},a),{target:a.target?a.target.map(function(u){return"#".concat(u.id)}):void 0,source:"#".concat(r.id)})}});return a},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=Be,a=s[o],u=a===void 0?[]:a,c=re(s,[typeof o=="symbol"?o:o+""]);i=j(Object.keys(c).map(function(w){!B&&w===Re&&K(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var T=Se(w,c[w]);return B||Si(n,w,T),T}).concat(Se(Be,u)))}var f=this.config.always?Se("",this.config.always):[],m=this.config.onDone?Se(String(rt(this.id)),this.config.onDone):[];B||K(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var p=j(this.invoke.map(function(w){var T=[];return w.onDone&&T.push.apply(T,U([],O(Se(String(nt(w.id)),w.onDone)),!1)),w.onError&&T.push.apply(T,U([],O(Se(String(Le(w.id)),w.onError)),!1)),T})),d=this.after,l=j(U(U(U(U([],O(m),!1),O(p),!1),O(i),!1),O(f),!1).map(function(w){return J(w).map(function(T){return n.formatTransition(T)})}));try{for(var h=R(d),y=h.next();!y.done;y=h.next()){var E=y.value;l.push(E)}}catch(w){e={error:w}}finally{try{y&&!y.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}return l},t}(),_r=!1;function xe(t,e){return!B&&!t.predictableActionArguments&&!_r&&(_r=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Ti(t,e)}var F=ei,H=Dt;function bi(t){return new TextEncoder().encode(t)}function me(t){const e=new Uint8Array(t);let r="";for(const i of e)r+=String.fromCharCode(i);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Ft(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return s}function Pr(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function Cr(t){const{id:e}=t;return{...t,id:Ft(e),transports:t.transports}}function kr(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}class q extends Error{constructor(e,r="WebAuthnError"){super(e),this.name=r}}function Ri({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new q("Registration ceremony was sent an abort signal","AbortError")}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new q("Discoverable credentials were required but no available authenticator supported it","ConstraintError");if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new q("User verification was required but no available authenticator supported it","ConstraintError")}else{if(t.name==="InvalidStateError")return new q("The authenticator was previously registered","InvalidStateError");if(t.name==="NotAllowedError")return new q("User clicked cancel, or the registration ceremony timed out","NotAllowedError");if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new q('No entry in pubKeyCredParams was of type "public-key"',"NotSupportedError"):new q("No available authenticator supported any of the specified pubKeyCredParams algorithms","NotSupportedError");if(t.name==="SecurityError"){const s=window.location.hostname;if(kr(s)){if(i.rp.id!==s)return new q(`The RP ID "${i.rp.id}" is invalid for this domain`,"SecurityError")}else return new q(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new q("User ID was not between 1 and 64 characters","TypeError")}else if(t.name==="UnknownError")return new q("The authenticator was unable to process the specified options, or could not create a new credential","UnknownError")}return t}class Oi{createNewAbortSignal(){return this.controller&&this.controller.abort(),this.controller=new AbortController,this.controller.signal}reset(){this.controller=void 0}}const ut=new Oi;async function Dr(t){if(!Pr())throw new Error("WebAuthn is not supported in this browser");const r={publicKey:{...t,challenge:Ft(t.challenge),user:{...t.user,id:bi(t.user.id)},excludeCredentials:t.excludeCredentials.map(Cr)}};r.signal=ut.createNewAbortSignal();let n;try{n=await navigator.credentials.create(r)}catch(c){throw Ri({error:c,options:r})}finally{ut.reset()}if(!n)throw new Error("Registration was not completed");const{id:i,rawId:s,response:o,type:a}=n,u={id:i,rawId:me(s),response:{attestationObject:me(o.attestationObject),clientDataJSON:me(o.clientDataJSON)},type:a,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:n.authenticatorAttachment};return typeof o.getTransports=="function"&&(u.transports=o.getTransports()),u}function Ai(t){return new TextDecoder("utf-8").decode(t)}async function xi(){if(navigator.credentials.conditionalMediationSupported)return!0;const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable!==void 0&&t.isConditionalMediationAvailable()}function Ni({error:t,options:e}){var r;const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new q("Authentication ceremony was sent an abort signal","AbortError")}else{if(t.name==="NotAllowedError")return!((r=n.allowCredentials)===null||r===void 0)&&r.length?new q("No available authenticator recognized any of the allowed credentials","NotAllowedError"):new q("User clicked cancel, or the authentication ceremony timed out","NotAllowedError");if(t.name==="SecurityError"){const i=window.location.hostname;if(kr(i)){if(n.rpId!==i)return new q(`The RP ID "${n.rpId}" is invalid for this domain`,"SecurityError")}else return new q(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="UnknownError")return new q("The authenticator was unable to process the specified options, or could not create a new assertion signature","UnknownError")}return t}async function Ii(t,e=!1){var r,n;if(!Pr())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)===null||r===void 0?void 0:r.length)!==0&&(i=(n=t.allowCredentials)===null||n===void 0?void 0:n.map(Cr));const s={...t,challenge:Ft(t.challenge),allowCredentials:i},o={};if(e){if(!await xi())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete*='webauthn']").length<1)throw Error('No <input> with `"webauthn"` in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=ut.createNewAbortSignal();let a;try{a=await navigator.credentials.get(o)}catch(d){throw Ni({error:d,options:o})}finally{ut.reset()}if(!a)throw new Error("Authentication was not completed");const{id:u,rawId:c,response:f,type:m}=a;let p;return f.userHandle&&(p=Ai(f.userHandle)),{id:u,rawId:me(c),response:{authenticatorData:me(f.authenticatorData),clientDataJSON:me(f.clientDataJSON),signature:me(f.signature),userHandle:p},type:m,clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:a.authenticatorAttachment}}const Ve="nhostRefreshToken",Ke="nhostRefreshTokenExpiresAt",Ur=3,Lr=300,Mr=5,Bt=0,Vt=1,Y=10,Ne=20;class $e extends Error{constructor(r){super(r.message);he(this,"error");Error.captureStackTrace(this,this.constructor),r instanceof Error?(this.name=r.name,this.error={error:r.name,status:Vt,message:r.message}):(this.name=r.error,this.error=r)}}const ne={status:Y,error:"invalid-email",message:"Email is incorrectly formatted"},jr={status:Y,error:"invalid-mfa-type",message:"MFA type is invalid"},Fr={status:Y,error:"invalid-mfa-code",message:"MFA code is invalid"},lt={status:Y,error:"invalid-password",message:"Password is incorrectly formatted"},Kt={status:Y,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},Br={status:Y,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},Vr={status:Y,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},_i={status:Y,error:"no-refresh-token",message:"No refresh token has been provided"},Pi={status:Ne,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},ee={status:Ne,error:"already-signed-in",message:"User is already signed in"},Kr={status:Ne,error:"unauthenticated-user",message:"User is not authenticated"},Ci={status:Ne,error:"user-not-anonymous",message:"User is not anonymous"},ki={status:Ne,error:"unverified-user",message:"Email needs verification"},Di={status:Y,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},Ui={status:Vt,error:"invalid-sign-in-method",message:"Invalid sign-in method"};function $r(t,e){return function(){return t.apply(e,arguments)}}const{toString:qr}=Object.prototype,{getPrototypeOf:$t}=Object,qt=(t=>e=>{const r=qr.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ie=t=>(t=t.toLowerCase(),e=>qt(e)===t),ft=t=>e=>typeof e===t,{isArray:Ie}=Array,qe=ft("undefined");function Li(t){return t!==null&&!qe(t)&&t.constructor!==null&&!qe(t.constructor)&&ve(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const zr=ie("ArrayBuffer");function Mi(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&zr(t.buffer),e}const ji=ft("string"),ve=ft("function"),Hr=ft("number"),zt=t=>t!==null&&typeof t=="object",Fi=t=>t===!0||t===!1,dt=t=>{if(qt(t)!=="object")return!1;const e=$t(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Bi=ie("Date"),Vi=ie("File"),Ki=ie("Blob"),$i=ie("FileList"),qi=t=>zt(t)&&ve(t.pipe),zi=t=>{const e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||qr.call(t)===e||ve(t.toString)&&t.toString()===e)},Hi=ie("URLSearchParams"),Gi=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ze(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),Ie(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{const s=r?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(n=0;n<o;n++)a=s[n],e.call(null,t[a],a,t)}}function Gr(t,e){e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const Wr=typeof self>"u"?typeof global>"u"?globalThis:global:self,Jr=t=>!qe(t)&&t!==Wr;function Ht(){const{caseless:t}=Jr(this)&&this||{},e={},r=(n,i)=>{const s=t&&Gr(e,i)||i;dt(e[s])&&dt(n)?e[s]=Ht(e[s],n):dt(n)?e[s]=Ht({},n):Ie(n)?e[s]=n.slice():e[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&ze(arguments[n],r);return e}const Wi=(t,e,r,{allOwnKeys:n}={})=>(ze(e,(i,s)=>{r&&ve(i)?t[s]=$r(i,r):t[s]=i},{allOwnKeys:n}),t),Ji=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Yi=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},Qi=(t,e,r,n)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&$t(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},Xi=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},Zi=t=>{if(!t)return null;if(Ie(t))return t;let e=t.length;if(!Hr(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},es=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&$t(Uint8Array)),ts=(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},rs=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},ns=ie("HTMLFormElement"),is=t=>t.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),Yr=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),ss=ie("RegExp"),Qr=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};ze(r,(i,s)=>{e(i,s,t)!==!1&&(n[s]=i)}),Object.defineProperties(t,n)},v={isArray:Ie,isArrayBuffer:zr,isBuffer:Li,isFormData:zi,isArrayBufferView:Mi,isString:ji,isNumber:Hr,isBoolean:Fi,isObject:zt,isPlainObject:dt,isUndefined:qe,isDate:Bi,isFile:Vi,isBlob:Ki,isRegExp:ss,isFunction:ve,isStream:qi,isURLSearchParams:Hi,isTypedArray:es,isFileList:$i,forEach:ze,merge:Ht,extend:Wi,trim:Gi,stripBOM:Ji,inherits:Yi,toFlatObject:Qi,kindOf:qt,kindOfTest:ie,endsWith:Xi,toArray:Zi,forEachEntry:ts,matchAll:rs,isHTMLForm:ns,hasOwnProperty:Yr,hasOwnProp:Yr,reduceDescriptors:Qr,freezeMethods:t=>{Qr(t,(e,r)=>{if(ve(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(!!ve(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},toObjectSet:(t,e)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return Ie(t)?n(t):n(String(t).split(e)),r},toCamelCase:is,noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:Gr,global:Wr,isContextDefined:Jr,toJSONObject:t=>{const e=new Array(10),r=(n,i)=>{if(zt(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;const s=Ie(n)?[]:{};return ze(n,(o,a)=>{const u=r(o,i+1);!qe(u)&&(s[a]=u)}),e[i]=void 0,s}}return n};return r(t,0)}};function N(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}v.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:v.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Xr=N.prototype,Zr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Zr[t]={value:t}}),Object.defineProperties(N,Zr),Object.defineProperty(Xr,"isAxiosError",{value:!0}),N.from=(t,e,r,n,i,s)=>{const o=Object.create(Xr);return v.toFlatObject(t,o,function(u){return u!==Error.prototype},a=>a!=="isAxiosError"),N.call(o,t.message,e,r,n,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};var os=typeof self=="object"?self.FormData:window.FormData;const as=os;function Gt(t){return v.isPlainObject(t)||v.isArray(t)}function en(t){return v.endsWith(t,"[]")?t.slice(0,-2):t}function tn(t,e,r){return t?t.concat(e).map(function(i,s){return i=en(i),!r&&s?"["+i+"]":i}).join(r?".":""):e}function cs(t){return v.isArray(t)&&!t.some(Gt)}const us=v.toFlatObject(v,{},null,function(e){return/^is[A-Z]/.test(e)});function ls(t){return t&&v.isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator]}function ht(t,e,r){if(!v.isObject(t))throw new TypeError("target must be an object");e=e||new(as||FormData),r=v.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,y){return!v.isUndefined(y[h])});const n=r.metaTokens,i=r.visitor||f,s=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&ls(e);if(!v.isFunction(i))throw new TypeError("visitor must be a function");function c(l){if(l===null)return"";if(v.isDate(l))return l.toISOString();if(!u&&v.isBlob(l))throw new N("Blob is not supported. Use a Buffer instead.");return v.isArrayBuffer(l)||v.isTypedArray(l)?u&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function f(l,h,y){let E=l;if(l&&!y&&typeof l=="object"){if(v.endsWith(h,"{}"))h=n?h:h.slice(0,-2),l=JSON.stringify(l);else if(v.isArray(l)&&cs(l)||v.isFileList(l)||v.endsWith(h,"[]")&&(E=v.toArray(l)))return h=en(h),E.forEach(function(T,_){!(v.isUndefined(T)||T===null)&&e.append(o===!0?tn([h],_,s):o===null?h:h+"[]",c(T))}),!1}return Gt(l)?!0:(e.append(tn(y,h,s),c(l)),!1)}const m=[],p=Object.assign(us,{defaultVisitor:f,convertValue:c,isVisitable:Gt});function d(l,h){if(!v.isUndefined(l)){if(m.indexOf(l)!==-1)throw Error("Circular reference detected in "+h.join("."));m.push(l),v.forEach(l,function(E,w){(!(v.isUndefined(E)||E===null)&&i.call(e,E,v.isString(w)?w.trim():w,h,p))===!0&&d(E,h?h.concat(w):[w])}),m.pop()}}if(!v.isObject(t))throw new TypeError("data must be an object");return d(t),e}function rn(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Wt(t,e){this._pairs=[],t&&ht(t,this,e)}const nn=Wt.prototype;nn.append=function(e,r){this._pairs.push([e,r])},nn.toString=function(e){const r=e?function(n){return e.call(this,n,rn)}:rn;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function fs(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function sn(t,e,r){if(!e)return t;const n=r&&r.encode||fs,i=r&&r.serialize;let s;if(i?s=i(e,r):s=v.isURLSearchParams(e)?e.toString():new Wt(e,r).toString(n),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class ds{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){v.forEach(this.handlers,function(n){n!==null&&e(n)})}}const on=ds,an={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hs=typeof URLSearchParams<"u"?URLSearchParams:Wt,ps=FormData,ms=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),se={isBrowser:!0,classes:{URLSearchParams:hs,FormData:ps,Blob},isStandardBrowserEnv:ms,protocols:["http","https","file","blob","url","data"]};function vs(t,e){return ht(t,new se.classes.URLSearchParams,Object.assign({visitor:function(r,n,i,s){return se.isNode&&v.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function ys(t){return v.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function gs(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}function cn(t){function e(r,n,i,s){let o=r[s++];const a=Number.isFinite(+o),u=s>=r.length;return o=!o&&v.isArray(i)?i.length:o,u?(v.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a):((!i[o]||!v.isObject(i[o]))&&(i[o]=[]),e(r,n,i[o],s)&&v.isArray(i[o])&&(i[o]=gs(i[o])),!a)}if(v.isFormData(t)&&v.isFunction(t.entries)){const r={};return v.forEachEntry(t,(n,i)=>{e(ys(n),i,r,0)}),r}return null}const Es={"Content-Type":void 0};function ws(t,e,r){if(v.isString(t))try{return(e||JSON.parse)(t),v.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const pt={transitional:an,adapter:["xhr","http"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=v.isObject(e);if(s&&v.isHTMLForm(e)&&(e=new FormData(e)),v.isFormData(e))return i&&i?JSON.stringify(cn(e)):e;if(v.isArrayBuffer(e)||v.isBuffer(e)||v.isStream(e)||v.isFile(e)||v.isBlob(e))return e;if(v.isArrayBufferView(e))return e.buffer;if(v.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return vs(e,this.formSerializer).toString();if((a=v.isFileList(e))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ht(a?{"files[]":e}:e,u&&new u,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),ws(e)):e}],transformResponse:[function(e){const r=this.transitional||pt.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(e&&v.isString(e)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?N.from(a,N.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:se.classes.FormData,Blob:se.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};v.forEach(["delete","get","head"],function(e){pt.headers[e]={}}),v.forEach(["post","put","patch"],function(e){pt.headers[e]=v.merge(Es)});const Jt=pt,Ss=v.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ts=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||e[r]&&Ss[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},un=Symbol("internals");function He(t){return t&&String(t).trim().toLowerCase()}function mt(t){return t===!1||t==null?t:v.isArray(t)?t.map(mt):String(t)}function bs(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}function Rs(t){return/^[-_a-zA-Z]+$/.test(t.trim())}function ln(t,e,r,n){if(v.isFunction(n))return n.call(this,e,r);if(!!v.isString(e)){if(v.isString(n))return e.indexOf(n)!==-1;if(v.isRegExp(n))return n.test(e)}}function Os(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function As(t,e){const r=v.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,s,o){return this[n].call(this,e,i,s,o)},configurable:!0})})}class vt{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function s(a,u,c){const f=He(u);if(!f)throw new Error("header name must be a non-empty string");const m=v.findKey(i,f);(!m||i[m]===void 0||c===!0||c===void 0&&i[m]!==!1)&&(i[m||u]=mt(a))}const o=(a,u)=>v.forEach(a,(c,f)=>s(c,f,u));return v.isPlainObject(e)||e instanceof this.constructor?o(e,r):v.isString(e)&&(e=e.trim())&&!Rs(e)?o(Ts(e),r):e!=null&&s(r,e,n),this}get(e,r){if(e=He(e),e){const n=v.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return bs(i);if(v.isFunction(r))return r.call(this,i,n);if(v.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=He(e),e){const n=v.findKey(this,e);return!!(n&&(!r||ln(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function s(o){if(o=He(o),o){const a=v.findKey(n,o);a&&(!r||ln(n,n[a],a,r))&&(delete n[a],i=!0)}}return v.isArray(e)?e.forEach(s):s(e),i}clear(){return Object.keys(this).forEach(this.delete.bind(this))}normalize(e){const r=this,n={};return v.forEach(this,(i,s)=>{const o=v.findKey(n,s);if(o){r[o]=mt(i),delete r[s];return}const a=e?Os(s):String(s).trim();a!==s&&delete r[s],r[a]=mt(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return v.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&v.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[un]=this[un]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=He(o);n[a]||(As(i,o),n[a]=!0)}return v.isArray(e)?e.forEach(s):s(e),this}}vt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),v.freezeMethods(vt.prototype),v.freezeMethods(vt);const oe=vt;function Yt(t,e){const r=this||Jt,n=e||r,i=oe.from(n.headers);let s=n.data;return v.forEach(t,function(a){s=a.call(r,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function fn(t){return!!(t&&t.__CANCEL__)}function Ge(t,e,r){N.call(this,t==null?"canceled":t,N.ERR_CANCELED,e,r),this.name="CanceledError"}v.inherits(Ge,N,{__CANCEL__:!0});const xs=null;function Ns(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new N("Request failed with status code "+r.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}const Is=se.isStandardBrowserEnv?function(){return{write:function(r,n,i,s,o,a){const u=[];u.push(r+"="+encodeURIComponent(n)),v.isNumber(i)&&u.push("expires="+new Date(i).toGMTString()),v.isString(s)&&u.push("path="+s),v.isString(o)&&u.push("domain="+o),a===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(r){const n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function _s(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Ps(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function dn(t,e){return t&&!_s(e)?Ps(t,e):e}const Cs=se.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let n;function i(s){let o=s;return e&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=i(window.location.href),function(o){const a=v.isString(o)?i(o):o;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}();function ks(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Ds(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(u){const c=Date.now(),f=n[s];o||(o=c),r[i]=u,n[i]=c;let m=s,p=0;for(;m!==i;)p+=r[m++],m=m%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),c-o<e)return;const d=f&&c-f;return d?Math.round(p*1e3/d):void 0}}function hn(t,e){let r=0;const n=Ds(50,250);return i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-r,u=n(a),c=s<=o;r=s;const f={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:u||void 0,estimated:u&&o&&c?(o-s)/u:void 0,event:i};f[e?"download":"upload"]=!0,t(f)}}const yt={http:xs,xhr:typeof XMLHttpRequest<"u"&&function(t){return new Promise(function(r,n){let i=t.data;const s=oe.from(t.headers).normalize(),o=t.responseType;let a;function u(){t.cancelToken&&t.cancelToken.unsubscribe(a),t.signal&&t.signal.removeEventListener("abort",a)}v.isFormData(i)&&se.isStandardBrowserEnv&&s.setContentType(!1);let c=new XMLHttpRequest;if(t.auth){const d=t.auth.username||"",l=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(d+":"+l))}const f=dn(t.baseURL,t.url);c.open(t.method.toUpperCase(),sn(f,t.params,t.paramsSerializer),!0),c.timeout=t.timeout;function m(){if(!c)return;const d=oe.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),h={data:!o||o==="text"||o==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:d,config:t,request:c};Ns(function(E){r(E),u()},function(E){n(E),u()},h),c=null}if("onloadend"in c?c.onloadend=m:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(m)},c.onabort=function(){!c||(n(new N("Request aborted",N.ECONNABORTED,t,c)),c=null)},c.onerror=function(){n(new N("Network Error",N.ERR_NETWORK,t,c)),c=null},c.ontimeout=function(){let l=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const h=t.transitional||an;t.timeoutErrorMessage&&(l=t.timeoutErrorMessage),n(new N(l,h.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,t,c)),c=null},se.isStandardBrowserEnv){const d=(t.withCredentials||Cs(f))&&t.xsrfCookieName&&Is.read(t.xsrfCookieName);d&&s.set(t.xsrfHeaderName,d)}i===void 0&&s.setContentType(null),"setRequestHeader"in c&&v.forEach(s.toJSON(),function(l,h){c.setRequestHeader(h,l)}),v.isUndefined(t.withCredentials)||(c.withCredentials=!!t.withCredentials),o&&o!=="json"&&(c.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&c.addEventListener("progress",hn(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",hn(t.onUploadProgress)),(t.cancelToken||t.signal)&&(a=d=>{!c||(n(!d||d.type?new Ge(null,t,c):d),c.abort(),c=null)},t.cancelToken&&t.cancelToken.subscribe(a),t.signal&&(t.signal.aborted?a():t.signal.addEventListener("abort",a)));const p=ks(f);if(p&&se.protocols.indexOf(p)===-1){n(new N("Unsupported protocol "+p+":",N.ERR_BAD_REQUEST,t));return}c.send(i||null)})}};v.forEach(yt,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Us={getAdapter:t=>{t=v.isArray(t)?t:[t];const{length:e}=t;let r,n;for(let i=0;i<e&&(r=t[i],!(n=v.isString(r)?yt[r.toLowerCase()]:r));i++);if(!n)throw n===!1?new N(`Adapter ${r} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(v.hasOwnProp(yt,r)?`Adapter '${r}' is not available in the build`:`Unknown adapter '${r}'`);if(!v.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:yt};function Qt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ge}function pn(t){return Qt(t),t.headers=oe.from(t.headers),t.data=Yt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Us.getAdapter(t.adapter||Jt.adapter)(t).then(function(n){return Qt(t),n.data=Yt.call(t,t.transformResponse,n),n.headers=oe.from(n.headers),n},function(n){return fn(n)||(Qt(t),n&&n.response&&(n.response.data=Yt.call(t,t.transformResponse,n.response),n.response.headers=oe.from(n.response.headers))),Promise.reject(n)})}const mn=t=>t instanceof oe?t.toJSON():t;function We(t,e){e=e||{};const r={};function n(c,f,m){return v.isPlainObject(c)&&v.isPlainObject(f)?v.merge.call({caseless:m},c,f):v.isPlainObject(f)?v.merge({},f):v.isArray(f)?f.slice():f}function i(c,f,m){if(v.isUndefined(f)){if(!v.isUndefined(c))return n(void 0,c,m)}else return n(c,f,m)}function s(c,f){if(!v.isUndefined(f))return n(void 0,f)}function o(c,f){if(v.isUndefined(f)){if(!v.isUndefined(c))return n(void 0,c)}else return n(void 0,f)}function a(c,f,m){if(m in e)return n(c,f);if(m in t)return n(void 0,c)}const u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,f)=>i(mn(c),mn(f),!0)};return v.forEach(Object.keys(t).concat(Object.keys(e)),function(f){const m=u[f]||i,p=m(t[f],e[f],f);v.isUndefined(p)&&m!==a||(r[f]=p)}),r}const vn="1.2.0",Xt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Xt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const yn={};Xt.transitional=function(e,r,n){function i(s,o){return"[Axios v"+vn+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,a)=>{if(e===!1)throw new N(i(o," has been removed"+(r?" in "+r:"")),N.ERR_DEPRECATED);return r&&!yn[o]&&(yn[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,o,a):!0}};function Ls(t,e,r){if(typeof t!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],o=e[s];if(o){const a=t[s],u=a===void 0||o(a,s,t);if(u!==!0)throw new N("option "+s+" must be "+u,N.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new N("Unknown option "+s,N.ERR_BAD_OPTION)}}const Zt={assertOptions:Ls,validators:Xt},fe=Zt.validators;class gt{constructor(e){this.defaults=e,this.interceptors={request:new on,response:new on}}request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=We(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Zt.assertOptions(n,{silentJSONParsing:fe.transitional(fe.boolean),forcedJSONParsing:fe.transitional(fe.boolean),clarifyTimeoutError:fe.transitional(fe.boolean)},!1),i!==void 0&&Zt.assertOptions(i,{encode:fe.function,serialize:fe.function},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o;o=s&&v.merge(s.common,s[r.method]),o&&v.forEach(["delete","get","head","post","put","patch","common"],l=>{delete s[l]}),r.headers=oe.concat(o,s);const a=[];let u=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(u=u&&h.synchronous,a.unshift(h.fulfilled,h.rejected))});const c=[];this.interceptors.response.forEach(function(h){c.push(h.fulfilled,h.rejected)});let f,m=0,p;if(!u){const l=[pn.bind(this),void 0];for(l.unshift.apply(l,a),l.push.apply(l,c),p=l.length,f=Promise.resolve(r);m<p;)f=f.then(l[m++],l[m++]);return f}p=a.length;let d=r;for(m=0;m<p;){const l=a[m++],h=a[m++];try{d=l(d)}catch(y){h.call(this,y);break}}try{f=pn.call(this,d)}catch(l){return Promise.reject(l)}for(m=0,p=c.length;m<p;)f=f.then(c[m++],c[m++]);return f}getUri(e){e=We(this.defaults,e);const r=dn(e.baseURL,e.url);return sn(r,e.params,e.paramsSerializer)}}v.forEach(["delete","get","head","options"],function(e){gt.prototype[e]=function(r,n){return this.request(We(n||{},{method:e,url:r,data:(n||{}).data}))}}),v.forEach(["post","put","patch"],function(e){function r(n){return function(s,o,a){return this.request(We(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}gt.prototype[e]=r(),gt.prototype[e+"Form"]=r(!0)});const Et=gt;class er{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{n.subscribe(a),s=a}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,a){n.reason||(n.reason=new Ge(s,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}static source(){let e;return{token:new er(function(i){e=i}),cancel:e}}}const Ms=er;function js(t){return function(r){return t.apply(null,r)}}function Fs(t){return v.isObject(t)&&t.isAxiosError===!0}function gn(t){const e=new Et(t),r=$r(Et.prototype.request,e);return v.extend(r,Et.prototype,e,{allOwnKeys:!0}),v.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return gn(We(t,i))},r}const z=gn(Jt);z.Axios=Et,z.CanceledError=Ge,z.CancelToken=Ms,z.isCancel=fn,z.VERSION=vn,z.toFormData=ht,z.AxiosError=N,z.Cancel=z.CanceledError,z.all=function(e){return Promise.all(e)},z.spread=js,z.isAxiosError=Fs,z.AxiosHeaders=oe,z.formToJSON=t=>cn(v.isHTMLForm(t)?new FormData(t):t),z.default=z;const Bs=z,ye=t=>{const e=Bs.create({baseURL:t});return e.interceptors.response.use(r=>r,r=>{var n,i,s,o,a,u,c,f,m,p,d,l;return Promise.reject({error:{message:(a=(o=(s=(i=(n=r.response)==null?void 0:n.data)==null?void 0:i.message)!=null?s:r.message)!=null?o:r.request.responseText)!=null?a:JSON.stringify(r),status:(p=(m=(u=r.response)==null?void 0:u.status)!=null?m:(f=(c=r.response)==null?void 0:c.data)==null?void 0:f.statusCode)!=null?p:Bt,error:((l=(d=r.response)==null?void 0:d.data)==null?void 0:l.error)||r.request.statusText||"network"}})}),e};/*! js-cookie v3.0.1 | MIT */function wt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Vs={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function tr(t,e){function r(i,s,o){if(!(typeof document>"u")){o=wt({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var u in o)!o[u]||(a+="; "+u,o[u]!==!0&&(a+="="+o[u].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+a}}function n(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},a=0;a<s.length;a++){var u=s[a].split("="),c=u.slice(1).join("=");try{var f=decodeURIComponent(u[0]);if(o[f]=t.read(c,f),i===f)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",wt({},s,{expires:-1}))},withAttributes:function(i){return tr(this.converter,wt({},this.attributes,i))},withConverter:function(i){return tr(wt({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var rr=tr(Vs,{path:"/"});const St=typeof window<"u",Tt=new Map,Ks=t=>{var e;return St&&typeof localStorage<"u"?localStorage.getItem(t):(e=Tt.get(t))!=null?e:null},$s=(t,e)=>{St&&typeof localStorage<"u"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?Tt.set(t,e):Tt.has(t)&&Tt.delete(t)},En=(t,e)=>{if(t==="localStorage"||t==="web")return Ks;if(t==="cookie")return r=>{var n;return St&&(n=rr.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},wn=(t,e)=>{if(t==="localStorage"||t==="web")return $s;if(t==="cookie")return(r,n)=>{St&&(n?rr.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):rr.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Sn=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},te=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),a=new URLSearchParams(o.search);let u=Object.fromEntries(a);r.startsWith("/")&&(u={...s,...u});let c=i.pathname;return o.pathname.length>1&&(c+=o.pathname.slice(1)),{...n,redirectTo:Sn(o.origin+c,u)}};function Je(t,e){var i;if(!e){if(typeof window>"u")return;e=((i=window.location)==null?void 0:i.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),n=r.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function nr(t){var r;if(typeof window>"u")return;const e=window==null?void 0:window.location;if(!!e&&e){const n=new URLSearchParams(e.search),i=new URLSearchParams((r=e.hash)==null?void 0:r.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const de=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),ir=t=>!!t&&typeof t=="string"&&t.length>=Ur,Tn=t=>!!t&&typeof t=="string",qs=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),sr={user:null,mfa:null,accessToken:{value:null,expiresAt:null},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}},zs=({backendUrl:t,clientUrl:e,interpreter:r})=>{const n=ye(t);return xe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:F({error:i=>ne}),saveRequestError:F({error:(i,{data:{error:s}})=>s}),reportError:H(i=>({type:"ERROR",error:i.error})),reportSuccess:H("SUCCESS")},guards:{invalidEmail:(i,{email:s})=>!de(s)},services:{requestChange:async(i,{email:s,options:o})=>(await n.post("/user/email/change",{newEmail:s,options:te(e,o)},{headers:{authorization:`Bearer ${r==null?void 0:r.getSnapshot().context.accessToken.value}`}})).data}})},Hs=({backendUrl:t,interpreter:e})=>{const r=ye(t);return xe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:F({error:n=>lt}),saveRequestError:F({error:(n,{data:{error:i}})=>i}),reportError:H(n=>({type:"ERROR",error:n.error})),reportSuccess:H("SUCCESS")},guards:{invalidPassword:(n,{password:i})=>!ir(i)},services:{requestChange:(n,{password:i,ticket:s})=>r.post("/user/password",{newPassword:i,ticket:s},{headers:{authorization:`Bearer ${e==null?void 0:e.getSnapshot().context.accessToken.value}`}})}})},Gs=({backendUrl:t,interpreter:e})=>{const r=ye(t);return xe({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating"},states:{initial:{},error:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}]},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}}}},{actions:{saveInvalidMfaTypeError:F({error:n=>jr}),saveInvalidMfaCodeError:F({error:n=>Fr}),saveError:F({error:(n,{data:{error:i}})=>i}),saveGeneration:F({imageUrl:(n,{data:{imageUrl:i}})=>i,secret:(n,{data:{totpSecret:i}})=>i}),reportError:H(n=>({type:"ERROR",error:n.error})),reportSuccess:H("SUCCESS"),reportGeneratedSuccess:H("GENERATED"),reportGeneratedError:H(n=>({type:"GENERATED_ERROR",error:n.error}))},guards:{invalidMfaCode:(n,{code:i})=>!i,invalidMfaType:(n,{activeMfaType:i})=>!i||i!=="totp"},services:{generate:async n=>{const{data:i}=await r.get("/mfa/totp/generate",{headers:{authorization:`Bearer ${e==null?void 0:e.getSnapshot().context.accessToken.value}`}});return i},activate:(n,{code:i,activeMfaType:s})=>r.post("/user/mfa",{code:i,activeMfaType:s},{headers:{authorization:`Bearer ${e==null?void 0:e.getSnapshot().context.accessToken.value}`}})}})},Ws=({backendUrl:t,clientUrl:e})=>{const r=ye(t);return xe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:F({error:n=>ne}),saveRequestError:F({error:(n,{data:{error:i}})=>i}),reportError:H(n=>({type:"ERROR",error:n.error})),reportSuccess:H("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!de(i)},services:{requestChange:(n,{email:i,options:s})=>r.post("/user/password/reset",{email:i,options:te(e,s)})}})},Js=({backendUrl:t,clientUrl:e})=>{const r=ye(t);return xe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:F({error:n=>ne}),saveRequestError:F({error:(n,{data:{error:i}})=>i}),reportError:H(n=>({type:"ERROR",error:n.error})),reportSuccess:H("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!de(i)},services:{request:async(n,{email:i,options:s})=>(await r.post("/user/email/send-verification-email",{email:i,options:te(e,s)})).data}})},bn=({backendUrl:t,clientUrl:e,clientStorageGetter:r,clientStorageSetter:n,clientStorageType:i="web",clientStorage:s,refreshIntervalTime:o,autoRefreshToken:a=!0,autoSignIn:u=!0})=>{const c=r||En(i,s),f=n||wn(i,s),m=ye(t),p=async(d,l,h)=>(await m.post(d,l,h)).data;return xe({schema:{context:{},events:{},services:{}},tsTypes:{},context:sr,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptRefreshToken"],exit:["destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_MFA_TOTP:"authenticating.mfa.totp"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged"],target:"pending"},onError:[{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:H("SIGNED_IN"),reportSignedOut:H("SIGNED_OUT"),reportTokenChanged:H("TOKEN_CHANGED"),incrementTokenImportAttempts:F({importTokenAttempts:({importTokenAttempts:d})=>d+1}),clearContext:F(()=>(f(Ke,null),f(Ve,null),{...sr})),clearContextExceptRefreshToken:F(({refreshToken:{value:d}})=>(f(Ke,null),{...sr,refreshToken:{value:d}})),saveSession:F({user:(d,{data:l})=>{var h;return((h=l==null?void 0:l.session)==null?void 0:h.user)||null},accessToken:(d,{data:l})=>{if(l.session){const{accessTokenExpiresIn:h,accessToken:y}=l.session,E=new Date(Date.now()+h*1e3);return f(Ke,E.toISOString()),{value:y,expiresAt:E}}return f(Ke,null),{value:null,expiresAt:null}},refreshToken:(d,{data:l})=>{var y;const h=((y=l.session)==null?void 0:y.refreshToken)||null;return h&&f(Ve,h),{value:h}}}),saveMfaTicket:F({mfa:(d,l)=>{var h;return(h=l.data)==null?void 0:h.mfa}}),resetTimer:F({refreshTimer:d=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:F({refreshTimer:(d,l)=>({startedAt:d.refreshTimer.startedAt,attempts:d.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:F({errors:({errors:d},{data:{error:l}})=>({...d,authentication:l})}),resetErrors:F({errors:d=>({}),importTokenAttempts:d=>0}),saveRegistrationError:F({errors:({errors:d},{data:{error:l}})=>({...d,registration:l})}),destroyRefreshToken:F({refreshToken:d=>(f(Ve,null),{value:null})}),cleanUrl:()=>{u&&Je("refreshToken")&&(nr("refreshToken"),nr("type"))},broadcastToken:d=>{if(u)try{new BroadcastChannel("nhost").postMessage(d.refreshToken.value)}catch{}}},guards:{isAnonymous:(d,l)=>{var h;return!!((h=d.user)!=null&&h.isAnonymous)},isSignedIn:d=>!!d.user&&!!d.refreshToken.value&&!!d.accessToken.value,noToken:d=>!d.refreshToken.value,hasRefreshToken:d=>!!d.refreshToken.value,isAutoRefreshDisabled:()=>!a,refreshTimerShouldRefresh:d=>{const{expiresAt:l}=d.accessToken;return l?d.refreshTimer.lastAttempt?Date.now()-d.refreshTimer.lastAttempt.getTime()>Mr*1e3:o&&Date.now()-d.refreshTimer.startedAt.getTime()>o*1e3?!0:l.getTime()-Date.now()-1e3*Lr<=0:!1},shouldRetryImportToken:(d,l)=>l.data.error.status===Bt||l.data.error.status>=500,unverified:(d,{data:{error:l}})=>l.status===401&&(l.message==="Email is not verified"||l.error==="unverified-user"),hasSession:(d,l)=>{var h;return!!((h=l.data)!=null&&h.session)},hasMfaTicket:(d,l)=>{var h;return!!((h=l.data)!=null&&h.mfa)}},services:{signInPassword:(d,{email:l,password:h})=>de(l)?ir(h)?p("/signin/email-password",{email:l,password:h}):Promise.reject({error:lt}):Promise.reject({error:ne}),passwordlessSms:(d,{phoneNumber:l,options:h})=>{var y;return Tn(l)?(y=d.user)!=null&&y.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),p("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:l,options:te(e,h)},{headers:{authorization:`Bearer ${d.accessToken.value}`}})):p("/signin/passwordless/sms",{phoneNumber:l,options:te(e,h)}):Promise.reject({error:Kt})},passwordlessSmsOtp:(d,{phoneNumber:l,otp:h})=>Tn(l)?p("/signin/passwordless/sms/otp",{phoneNumber:l,otp:h}):Promise.reject({error:Kt}),passwordlessEmail:(d,{email:l,options:h})=>{var y;return de(l)?(y=d.user)!=null&&y.isAnonymous?p("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:l,options:te(e,h)},{headers:{authorization:`Bearer ${d.accessToken.value}`}}):p("/signin/passwordless/email",{email:l,options:te(e,h)}):Promise.reject({error:ne})},signInAnonymous:d=>p("/signin/anonymous"),signInMfaTotp:(d,l)=>{var y;const h=l.ticket||((y=d.mfa)==null?void 0:y.ticket);return h?qs(h)?p("/signin/mfa/totp",{ticket:h,otp:l.otp}):Promise.reject({error:Br}):Promise.reject({error:Vr})},signInSecurityKeyEmail:async(d,{email:l})=>{if(!de(l))throw new $e(ne);const h=await p("/signin/webauthn",{email:l});let y;try{y=await Ii(h)}catch(E){throw new $e(E)}return p("/signin/webauthn/verify",{email:l,credential:y})},refreshToken:async(d,l)=>{const h=l.type==="TRY_TOKEN"?l.token:d.refreshToken.value;return{session:await p("/token",{refreshToken:h}),error:null}},signout:(d,l)=>p("/signout",{refreshToken:d.refreshToken.value,all:!!l.all}),signUpEmailPassword:async(d,{email:l,password:h,options:y})=>{var E;return de(l)?ir(h)?(E=d.user)!=null&&E.isAnonymous?p("/user/deanonymize",{signInMethod:"email-password",email:l,password:h,options:te(e,y)},{headers:{authorization:`Bearer ${d.accessToken.value}`}}):p("/signup/email-password",{email:l,password:h,options:te(e,y)}):Promise.reject({error:lt}):Promise.reject({error:ne})},signUpSecurityKey:async(d,{email:l,options:h})=>{if(!de(l))return Promise.reject({error:ne});const y=h==null?void 0:h.nickname;y&&delete h.nickname;const E=await p("/signup/webauthn",{email:l,options:h});let w;try{w=await Dr(E)}catch(T){throw new $e(T)}return p("/signup/webauthn/verify",{credential:w,options:{redirectTo:h==null?void 0:h.redirectTo,nickname:y}})},importRefreshToken:async()=>{let d=null;if(u){const h=Je("refreshToken")||null;if(h)try{return{session:await p("/token",{refreshToken:h}),error:null}}catch(y){d=y.error}else{const y=Je("error");if(y)return Promise.reject({session:null,error:{status:Y,error:y,message:Je("errorDescription")||y}})}}const l=await c(Ve);if(l)try{return{session:await p("/token",{refreshToken:l}),error:null}}catch(h){d=h.error}return d?Promise.reject({error:d,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:d})=>d<5?1e3:5e3}})};class Rn{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,devTools:a,...u}){he(this,"backendUrl");he(this,"clientUrl");he(this,"machine");he(this,"_interpreter");he(this,"_channel");he(this,"_subscriptions",new Set);if(this.backendUrl=s,this.clientUrl=o,this.machine=bn({...u,backendUrl:s,clientUrl:o,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&(this.interpreter=Ir(this.machine,{devTools:a}),this.interpreter.start()),typeof window<"u"&&r)try{this._channel=new BroadcastChannel("nhost"),this._channel.addEventListener("message",c=>{var m;const f=(m=this.interpreter)==null?void 0:m.getSnapshot().context.refreshToken.value;this.interpreter&&c.data!==f&&this.interpreter.send("TRY_TOKEN",{token:c.data})})}catch{}}get interpreter(){return this._interpreter}set interpreter(e){this._interpreter=e,e&&this._subscriptions.forEach(r=>r(this))}onStart(e){this.interpreter?e(this):this._subscriptions.add(e)}}const On=typeof window<"u";class An extends Rn{constructor({...e}){super({...e,autoSignIn:On&&e.autoSignIn,autoRefreshToken:On&&e.autoRefreshToken,clientStorageType:"cookie"})}}const Ys=An,Qs=async({backendUrl:t,interpreter:e},r)=>{const n=ye(t);try{const{data:i}=await n.post("/user/webauthn/add",{},{headers:{authorization:`Bearer ${e==null?void 0:e.getSnapshot().context.accessToken.value}`}});let s;try{s=await Dr(i)}catch(a){throw new $e(a)}const{data:o}=await n.post("/user/webauthn/verify",{credential:s,nickname:r},{headers:{authorization:`Bearer ${e==null?void 0:e.getSnapshot().context.accessToken.value}`}});return{key:o,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1}}},Xs=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),Zs=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),eo=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||""}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:""})})}),to=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),ro=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),no=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),io=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:ee,user:null,accessToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null})})}),so=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,error:ee,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),oo=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:ee,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),ao=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,error:ee,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})}),co=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,error:ee,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),uo=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:ee,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),lo=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:ee,isError:!0,isSuccess:!1,user:null,accessToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null})})}),fo=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:Kr});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),ho=(t,e,r,n)=>new Promise(i=>{const{changed:s,context:o}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n});if(!s)return i({error:ee,accessToken:o.accessToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});t.onTransition(a=>{a.matches("registration.incomplete.failed")?i({accessToken:null,error:a.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):a.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:a.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:a.context.user})})}),po=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r});if(!i)return n({error:ee,accessToken:s.accessToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:s.user});t.onTransition(o=>{o.matches("registration.incomplete.failed")?n({accessToken:null,error:o.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):o.matches({authentication:"signedIn",registration:"complete"})&&n({accessToken:o.context.accessToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:o.context.user})})});S.AuthClient=Rn,S.AuthClientSSR=Ys,S.AuthCookieClient=An,S.CodifiedError=$e,S.EMAIL_NEEDS_VERIFICATION=ki,S.INVALID_EMAIL_ERROR=ne,S.INVALID_MFA_CODE_ERROR=Fr,S.INVALID_MFA_TICKET_ERROR=Br,S.INVALID_MFA_TYPE_ERROR=jr,S.INVALID_PASSWORD_ERROR=lt,S.INVALID_PHONE_NUMBER_ERROR=Kt,S.INVALID_REFRESH_TOKEN=Di,S.INVALID_SIGN_IN_METHOD=Ui,S.MIN_PASSWORD_LENGTH=Ur,S.NETWORK_ERROR_CODE=Bt,S.NHOST_JWT_EXPIRES_AT_KEY=Ke,S.NHOST_REFRESH_TOKEN_KEY=Ve,S.NO_MFA_TICKET_ERROR=Vr,S.NO_REFRESH_TOKEN=_i,S.OTHER_ERROR_CODE=Vt,S.REFRESH_TOKEN_RETRY_INTERVAL=Mr,S.STATE_ERROR_CODE=Ne,S.TOKEN_REFRESHER_RUNNING_ERROR=Pi,S.TOKEN_REFRESH_MARGIN=Lr,S.USER_ALREADY_SIGNED_IN=ee,S.USER_NOT_ANONYMOUS=Ci,S.USER_UNAUTHENTICATED=Kr,S.VALIDATION_ERROR_CODE=Y,S.activateMfaPromise=to,S.addSecurityKeyPromise=Qs,S.changeEmailPromise=Xs,S.changePasswordPromise=Zs,S.createAuthMachine=bn,S.createChangeEmailMachine=zs,S.createChangePasswordMachine=Hs,S.createEnableMfaMachine=Gs,S.createResetPasswordMachine=Ws,S.createSendVerificationEmailMachine=Js,S.encodeQueryParameters=Sn,S.generateQrCodePromise=eo,S.getParameterByName=Je,S.localStorageGetter=En,S.localStorageSetter=wn,S.removeParameterFromWindow=nr,S.resetPasswordPromise=ro,S.rewriteRedirectTo=te,S.sendVerificationEmailPromise=no,S.signInAnonymousPromise=io,S.signInEmailPasswordPromise=so,S.signInEmailPasswordlessPromise=oo,S.signInEmailSecurityKeyPromise=ao,S.signInMfaTotpPromise=co,S.signInSmsPasswordlessOtpPromise=lo,S.signInSmsPasswordlessPromise=uo,S.signOutPromise=fo,S.signUpEmailPasswordPromise=ho,S.signUpEmailSecurityKeyPromise=po,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=core.umd.js.map
